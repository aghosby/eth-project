<div class="page-wrap">
    <header>
        <div class="logo-cont">
            <img routerLink="/" src="assets/img/project/eth-logo-wht.png" alt="">
        </div>

        <nav>
            <ul>
                <li>
                <a href="#about">About</a>
                </li>
                <li>
                <a href="#auditions">Auditions</a>
                </li>
                <li>
                <a href="#register">How to Participate</a>
                </li>
                <li>
                <a class="text-white" (click)="contactForm()" role="button">Contact Us</a>
                </li>
            </ul>
        </nav>

        <div class="header-ctas">
        
            <div (click)="goToLogin()" class="user">
                <div class="image"><i class="bi bi-person-circle"></i></div>
                <span>Login</span>
                <!-- <div class="name">Admin {{loggedInUser.lastName}}</div> -->
            </div>
            <button [routerLink]="'/tickets'">Buy Tickets</button>
        </div>
    </header>


    <main>
        <section class="hero" style="background-image: url('assets/img/project/hero-bkg.jpg');">
            <div class="overlay"></div>

            <div class="caption-wrap">
                <h1>✨ Grand finale Tickets ✨</h1>
                <div class="sec-text">
                    The Grand Finale takes place on 14th January 2026, and you don’t want to miss it. This is where the journey ends, the spotlight shines brightest, and the stars are made.                
                </div>
            </div>
        </section>

        <section class="ticket-sale pad-x mt-lg-5 mt-4">
            <div class="row d-flex justify-content-between">
                <!-- LEFT: ticket list + form -->
                <div class="col-lg-6">
                    <h3>Buy Tickets</h3>
                    <div class="ticket-types">
                        <div
                            *ngFor="let ticket of ticketTypes; let i = index; trackBy: trackById"
                            class="ticket-hld"
                            [ngClass]="getTypeClass(ticket)"
                        >
                            <div class="ticket-desc">
                                <div class="icon" [attr.aria-hidden]="true">
                                <i class="bi bi-ticket-perforated"></i>
                                </div>

                                <div class="info">
                                <div class="name">{{ ticket.name }}</div>
                                <div class="sub">Per ticket</div>
                                </div>

                                <div class="amount">
                                <span class="price">₦ {{ ticket.price | number:'1.0-0' }}</span>
                                </div>
                            </div>

                            <div class="ticket-count">
                                <button
                                    class="btn btn-sm btn-decr"
                                    (click)="decrement(ticket)"
                                    [disabled]="ticket.quantity === 0"
                                    aria-label="Decrease quantity"
                                >
                                -
                                </button>

                                <div class="count">{{ ticket.quantity }}</div>

                                <button
                                    class="btn btn-sm btn-incr"
                                    (click)="increment(ticket)"
                                    aria-label="Increase quantity"
                                >
                                +
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="purchase-info mt-lg-5 mt-4">
                        <h3>Personal Details</h3>
                        <form [formGroup]="buyerForm" (ngSubmit)="onSubmit()" novalidate>
                            <div class="row g-3">
                                <div class="col-md-6 col-12">
                                    <mat-form-field appearance="outline" class="w-100">
                                        <mat-label>First name</mat-label>
                                        <input matInput formControlName="firstName" required />
                                        <mat-error *ngIf="buyerForm.get('firstName')?.hasError('required')">
                                        First name is required
                                        </mat-error>
                                    </mat-form-field>
                                </div>

                                <div class="col-md-6 col-12">
                                    <mat-form-field appearance="outline" class="w-100">
                                        <mat-label>Last name</mat-label>
                                        <input matInput formControlName="lastName" required />
                                        <mat-error *ngIf="buyerForm.get('lastName')?.hasError('required')">
                                        Last name is required
                                        </mat-error>
                                    </mat-form-field>
                                </div>

                                <div class="col-12">
                                    <mat-form-field appearance="outline" class="w-100">
                                        <mat-label>Email</mat-label>
                                        <input matInput formControlName="email" required type="email" />
                                        <mat-error *ngIf="buyerForm.get('email')?.hasError('required')">
                                            Email is required
                                        </mat-error>
                                        <mat-error *ngIf="buyerForm.get('email')?.hasError('email')">
                                            Provide a valid email
                                        </mat-error>
                                    </mat-form-field>
                                </div>

                                <div class="col-12">
                                    <mat-form-field appearance="outline" class="w-100">
                                        <mat-label>Phone (optional)</mat-label>
                                        <input matInput formControlName="phone" type="tel" />
                                    </mat-form-field>
                                </div>

                                <!-- hidden submit so pressing enter validates -->
                                <div class="col-12 d-none">
                                    <button mat-raised-button type="submit">Submit</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- RIGHT: summary -->
                <div class="col-lg-5 mt-lg-0 mt-4">
                    <div class="hdr">
                        <h3>Ticket Summary</h3>
                    </div>

                    <div class="ticket-summary card">
                        <div class="card-body p-3">
                        <h5 class="section-title">Purchase summary</h5>

                        <ng-container *ngIf="selectedTickets.length; else noneSelected">
                            <div class="summary-list">
                            <div
                                class="summary-item"
                                *ngFor="let t of selectedTickets"
                            >
                                <div class="left">
                                    <div class="label">{{ t.name }} x{{ t.quantity }}</div>
                                </div>
                                <div class="right">
                                    <div class="value">₦ {{ (t.price * t.quantity) | number:'1.0-0' }}</div>
                                </div>
                            </div>

                            <div class="summary-item total">
                                <div class="left"><strong>Grand total</strong></div>
                                <div class="right"><strong>₦ {{ grandTotal | number:'1.0-0' }}</strong></div>
                            </div>
                            </div>
                        </ng-container>

                        <ng-template #noneSelected>
                            <div class="empty">No tickets selected yet.</div>
                        </ng-template>
                        </div>
                    </div>

                    <div class="ticket-info card mt-3">
                        <div class="card-body p-3">
                        <h5 class="section-title">Buyer information</h5>

                        <div class="buyer-list">
                            <div class="buyer-item">
                            <div class="label">First name</div>
                            <div class="value">{{ buyerForm.get('firstName')?.value || '—' }}</div>
                            </div>

                            <div class="buyer-item">
                            <div class="label">Last name</div>
                            <div class="value">{{ buyerForm.get('lastName')?.value || '—' }}</div>
                            </div>

                            <div class="buyer-item">
                            <div class="label">Email</div>
                            <div class="value">{{ buyerForm.get('email')?.value || '—' }}</div>
                            </div>

                            <div class="buyer-item">
                            <div class="label">Phone</div>
                            <div class="value">{{ buyerForm.get('phone')?.value || '—' }}</div>
                            </div>
                        </div>
                        </div>
                    </div>

                    <div class="action mt-3">
                        <!-- Payment button intentionally left out per requirements -->
                        <button class="cta cta-primary w-100" (click)="makePayment()">
                            Make Payment
                        </button>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <div class="mt-5">
        <app-footer></app-footer>
    </div>
</div>